<launch>
    <!-- ========================================= -->
    <arg name="use_sim_time" default="true"/>
    <arg name="log_level" default="warn"/>

    <arg name="image_size" default="800"/>
    <arg name="max_range" default="20.0"/>

    <!-- ========================================= -->
    <node name="camera_corrector" pkg="sign_detector" exec="camera_corrector_node" output="screen" args="--ros-args --log-level info">
        <param name="use_sim_time" value="$(var use_sim_time)"/>
        <param name="image_size" value="800"/>
        <!-- <param name="max_range" value="$(var max_range)"/> -->
        <param name="max_range" value="40.0"/>
        <param name="gamma" value="3.0"/>
        <param name="score_offset" value="-128.0"/>
        <param name="max_raw_score" value="100000.0"/>
        <param name="min_prob" value="0.1"/>

        <remap from="/weighted_particles" to="/camera/weighted_particles"/>
    </node>

    <node name="gnss_corrector" pkg="sign_detector" exec="gnss_corrector_node" output="screen" args="--ros-args --log-level info">
        <param name="use_sim_time" value="$(var use_sim_time)"/>
        <param name="min_prob" value="0.1"/>
        <param name="flat_radius" value="5.0"/>
        <param name="sigma" value="4.0"/>
        <remap from="/weighted_particles" to="/gnss/weighted_particles"/>
    </node>

    <node if="true" pkg="topic_tools" exec="relay" name="gnss_corrector_relay">
        <param name="input_topic" value="/gnss/weighted_particles" />
        <param name="output_topic" value="/weighted_particles" />
        <param name="type" value="modularized_particle_filter_msgs/msg/ParticleArray" />
    </node>

    <node if="true" pkg="topic_tools" exec="relay" name="camera_corrector_relay" args="--ros-args --log-level warn">
        <param name="input_topic" value="/camera/weighted_particles" />
        <param name="output_topic" value="/weighted_particles" />
        <param name="type" value="modularized_particle_filter_msgs/msg/ParticleArray" />
    </node>
</launch>

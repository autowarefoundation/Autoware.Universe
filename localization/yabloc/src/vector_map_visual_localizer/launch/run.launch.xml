<launch>
    <arg name="use_sim_time" default="true"/>
    <arg name="log_level" default="warn"/>

    <arg name="src_image" default="/sensing/camera/traffic_light/image_raw/compressed"/>
    <arg name="src_info" default="/sensing/camera/traffic_light/camera_info"/>
    <arg name="resized_image" default="/sensing/camera/undistorted/image_raw"/>
    <arg name="resized_info" default="/sensing/camera/undistorted/camera_info"/>

    <arg name="road_marking_labels" default="[zebra_marking, virtual, line_thin, line_thick, pedestrian_marking, stop_line]"/>
    <arg name="rtk_enabled" default="true"/>
    <arg name="min_segment_length" default="-1.0"/>
    <arg name="max_segment_distance" default="-1.0"/>

    <!-- ========================================= -->
    <!-- ============ PARTICLE FILTER ============ -->
    <!-- ========================================= -->
    <include file="$(find-pkg-share vector_map_visual_localizer)/launch/impl/pf.launch.xml">
        <arg name="use_sim_time" value="$(var use_sim_time)" />
        <arg name="log_level" value="$(var log_level)"/>
        <arg name="rtk_enabled" value="$(var rtk_enabled)"/>
    </include>

    <!-- ========================================= -->
    <!-- ============ IMAGE PROCESSING =========== -->
    <!-- ========================================= -->
    <include file="$(find-pkg-share vector_map_visual_localizer)/launch/impl/imgproc.launch.xml">
        <arg name="use_sim_time" value="$(var use_sim_time)" />
        <arg name="log_level" value="$(var log_level)"/>
        <arg name="src_image" value="$(var src_image)"/>
        <arg name="src_info" value="$(var src_info)"/>
        <arg name="resized_image" value="$(var resized_image)"/>
        <arg name="resized_info" value="$(var resized_info)"/>
        <arg name="min_segment_length" value="$(var min_segment_length)"/>
        <arg name="max_segment_distance" value="$(var max_segment_distance)"/>
    </include>

    <!-- ========================================= -->
    <!-- =============== TRAJECTORY ============== -->
    <!-- ========================================= -->
    <include file="$(find-pkg-share vector_map_visual_localizer)/launch/impl/trajectory.launch.xml">
        <arg name="use_sim_time" value="$(var use_sim_time)" />
        <arg name="log_level" value="$(var log_level)"/>
    </include>

    <!-- ========================================= -->
    <!-- =============== VALIDATION ============== -->
    <!-- ========================================= -->
    <group>
        <push-ros-namespace namespace="validation"/>
        <include file="$(find-pkg-share vector_map_visual_localizer)/launch/impl/validation.launch.xml"/>
    </group>

    <!-- ========================================= -->
    <!-- ================ LANELET2 =============== -->
    <!-- ========================================= -->
    <node name="ll2_decompose" pkg="vector_map_visual_localizer" exec="ll2_decompose_node" output="log" args="--ros-args --log-level $(var log_level)">
        <param name="use_sim_time" value="$(var use_sim_time)"/>
        <param name="road_marking_labels" value="$(var road_marking_labels)"/>
    </node>

    <!-- ========================================= -->
    <!-- ================ SIGN BOARD ============= -->
    <!-- ========================================= -->
    <node if="false" name="sign_node" pkg="vector_map_visual_localizer" exec="sign_node" output="screen" args="--ros-args --log-level info">
        <remap from="/src_image" to="$(var resized_image)"/>
        <remap from="/src_info" to="$(var resized_info)"/>
    </node>

</launch>